var shellPerformance=window.performance,HighResolutionTimingSupported=!!shellPerformance&&"function"==typeof shellPerformance.mark;HighResolutionTimingSupported&&shellPerformance.mark("shell_chat_start"),(self["suiteux_shell_webpackJsonp_suiteux-main"]=self["suiteux_shell_webpackJsonp_suiteux-main"]||[]).push([["chat"],{42360:function(t,e,n){(e=t.exports=n(29626)(!1)).push([t.id,".w4P7LBKjs8s7OCcvAbPoBQ\\=\\={display:inline-block;font-size:19px;vertical-align:middle}",""]),e.locals={icon:"w4P7LBKjs8s7OCcvAbPoBQ=="}},72865:function(t,e,n){var a=n(42360);"string"==typeof a&&(a=[[t.id,a,""]]);var i={hmr:!0,transform:undefined,insertInto:void 0};n(79128)(a,i);a.locals&&(t.exports=a.locals)},97661:function(t,e,n){"use strict";n.d(e,{B:function(){return C},o:function(){return m}});var a=n(90872),i=n(95144),s=n(18435),o=n(40141),r=n(16968),l=n(99542),c=n(72865),h=n(90223),u=n(57530),d=n(61304);let p;const C=t=>{let e=t instanceof MouseEvent;if(t instanceof KeyboardEvent)switch(t.which){case 40:e=t.altKey;break;case 13:case 32:e=!0}e&&function(t){t.preventDefault(),window.open(p),(0,r.tZ)().click("ChatButton","NavBar",null,null,"Default chat web page")}(t)};class m extends a.Component{constructor(t){super(t),this.onMouseChange=t=>this.setState({isHovered:t}),this.state={isHovered:!1},p=this.props.chatWebLink}render(){if(!this.props.chatEnabled)return null;let t=this.props.isConsumerShell?"SkypeLogo":"OfficeChat",e=(0,o.e)();const n=this.props.unreadBadgeValue>0?"":null;return a.createElement("button",{type:"button",id:l.YZ,className:(0,i.AH)(h.button,e.headerButton),"aria-disabled":"false",title:d.D.Chat,"aria-label":d.D.Chat,role:"button",onMouseEnter:this.onMouseChange.bind(this,!0),onMouseLeave:this.onMouseChange.bind(this,!1)},a.createElement(i.rP,{fontIconCss:`ms-Icon--${t}`,fontSize:u.LV.toString(),className:(0,i.AH)(c.icon),isAriaHidden:!0}),a.createElement(i.xw,{unseenItemCount:this.props.unreadBadgeValue,isParentHovered:this.state.isHovered,badgeStyles:(0,i.AH)(h.headerButtonBadgePosition),badgeCharacter:n}))}componentDidMount(){(0,i.lQ)([l.YZ],`${s.B.CLICK} ${s.B.KEYDOWN}`,C)}}},3924:function(t,e,n){"use strict";n.r(e),n.d(e,{ChatHeaderButtonConnector:function(){return k},ChatIconConnector:function(){return B},initializeChatComponent:function(){return D}});var a=n(90872),i=n(9028),s=n(73567),o=n(82453),r=n(16968),l=n(16533);const c=(0,n(53512)._)((()=>n.e("chatbase").then(n.bind(n,64964)).then((t=>t.ChatBaseControlConnector))));class h extends a.Component{constructor(t){super(t),this.state={shouldPreAuth:!1}}render(){const{shouldPreAuth:t}=this.state;return this.props.shouldInitChatOnFirstClick||t?a.createElement(c,null):null}componentDidMount(){this.fetchShouldPreAuth()}fetchShouldPreAuth(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){if(yield this.props.isTeamsAvailable){const t=yield this.props.shouldLoadEmbedChatPreAuthOnIdle;this.setState({shouldPreAuth:t})}}))}}const u=(0,s.connect)((t=>{const e=t.shellInitDataState;return{shouldInitChatOnFirstClick:t.chatState.initChatOnFirstClick,shouldLoadEmbedChatPreAuthOnIdle:e.renderSettings.shouldLoadEmbedChatPreAuthOnIdle,isTeamsAvailable:e.renderSettings.shouldEnableChat}}))(h);var d=n(95144),p=n(88242),C=n(47275),m=n(37671),f=n.n(m),b=n(57530),g=n(90223),v=n.n(g),I=n(61304);class S extends a.Component{constructor(t){super(t),this.chatEnablementPromise=null,this.state={isHovered:!1,delayRender:!!t.shouldEnableChat}}componentDidMount(){return(0,l.__awaiter)(this,void 0,void 0,(function*(){if(this.state.delayRender){this.chatEnablementPromise=(0,p.l)(this.props.shouldEnableChat);try{const t=yield this.chatEnablementPromise.promise;this.setState({delayRender:!t})}catch(t){t&&!t.isCancelled&&(0,r.tZ)().exception("Chat_Delay_Initialization_Failed",6,t)}}this.props.isAvailable&&(0,r.tZ)().perfMarker("ChatTimeToInteractive")}))}componentWillUnmount(){var t;null===(t=this.chatEnablementPromise)||void 0===t||t.cancel()}getAriaLabel(){let t=I.D.Chat;return void 0!==this.props.unseenItemCount&&0!==this.props.unseenItemCount&&(t=I.D.ChatUnreadItems),t}render(){if(!this.props.chatEnabled||this.state.delayRender)return null;const t={controlID:this.props.id,isVisible:this.props.isAvailable,ariaLabel:this.getAriaLabel(),affordanceMenuItemText:I.D.Chat,iconID:this.props.isConsumerShell?"SkypeLogo":"OfficeChat",iconFontSize:b.LV.toString(),isActive:this.props.isActive,isDarkModeEnabled:this.props.isDarkModeEnabled,onClick:this.props.onClick,onHoverStateChanged:t=>{this.setState({isHovered:t})},onDimensionsChanged:this.props.controlDimensionsChanged},e=this.props.unseenItemCount>0?"":null;return 0===this.props.renderContext?a.createElement(C.hp,Object.assign({},t),a.createElement(d.xw,{unseenItemCount:this.props.unseenItemCount,isParentHovered:this.state.isHovered,badgeStyles:v().headerButtonBadgePosition,badgeCharacter:e})):a.createElement(C.vO,Object.assign({},t),a.createElement(d.xw,{unseenItemCount:this.props.unseenItemCount,isParentHovered:this.state.isHovered,badgeStyles:f().affordanceContextMenuItemBadgePosition,badgeCharacter:e}))}}var P=n(50003),A=n(30191);const k=(0,s.connect)(((t,e)=>{var n,a;let i=function(t){let e=!1,n=!1;t.chatState.chatEnabled&&(e=!t.shellInitDataState.renderSettings.initChatOnPageLoad,null!==t.chatState.isChatAPIInitialized&&(t.chatState.isChatAPIInitialized?e=!0:t.userState.isConsumer&&(e=!0,n=!0)));return{showButton:e,useButtonAsLink:n}}(t);return{isAvailable:i.showButton,id:e&&e.id,isActive:null!==(n=t.chatState&&t.chatState.isChatRecentsPaneOpen)&&void 0!==n&&n,useButtonAsLink:i.useButtonAsLink,chatWebLink:t.chatState&&t.chatState.chatWebLink,chatEnabled:t.chatState&&t.chatState.chatEnabled,isConsumerShell:null===(a=t.shellInitDataState.clientData)||void 0===a?void 0:a.IsConsumerShell,controlDimensionsChanged:e.controlDimensionsChanged,isChatRecentsPaneInitialized:t.chatState.isChatRecentsPaneInitialized,isChatAPIInitialized:t.chatState.isChatAPIInitialized,unseenItemCount:t.chatState.unreadBadgeValue,shouldEnableChat:t.shellInitDataState.renderSettings.shouldEnableChat}}),(t=>({onClick:(e,n)=>{e.stopPropagation(),(0,r.tZ)().click("ChatButton","NavBar",null,null,`Active state: ${n.isActive}, Render context: ${n.renderContext}, Use Button as Link: ${n.useButtonAsLink}`),n.onClick&&n.onClick(e),n.useButtonAsLink?(e.preventDefault(),window.open(n.chatWebLink)):(n.isChatAPIInitialized?n.isChatRecentsPaneInitialized||(0,P.g2)((()=>{t((0,A.U3)(!0))}),((e,n)=>{t((0,A.i$)(e)),t((0,d.ad)(n))})):t((0,A.PM)(!0)),t((0,A.i$)(!n.isActive)),t((0,d.ad)(e.currentTarget&&e.currentTarget.id)))}})),((t,e,n)=>{let a=Object.assign(Object.assign({},n),t);return Object.assign(Object.assign(Object.assign({},a),e),{onClick:t=>e.onClick(t,a),onDimensionsChanged:()=>e.onDimensionsChanged(a)})}))(S);var E=n(97661);const B=(0,s.connect)((t=>({unreadBadgeValue:t.chatState.unreadBadgeValue,chatEnabled:t.chatState.chatEnabled,chatWebLink:t.chatState.chatWebLink,isConsumerShell:t.shellInitDataState&&t.shellInitDataState.clientData.IsConsumerShell})))(E.o);function D(){const t=document.createElement("div");document.getElementById((0,r.GJ)().top).appendChild(t);const e=(0,o.O)();i.render(a.createElement(s.Provider,{store:e},a.createElement(u,null)),t)}},30191:function(t,e,n){"use strict";n.d(e,{Dg:function(){return h},PM:function(){return d},U3:function(){return o},WD:function(){return u},Xi:function(){return c},_A:function(){return r},i$:function(){return s},y7:function(){return l}});var a=n(7102),i=n(29081);function s(t){return{type:a.ui,isRecentsOpen:t}}function o(t){return{type:i.wW,isRecentsInitialized:t}}function r(t){return{type:i.I2,isChatAPIInitialized:t}}function l(t){return{type:i.FQ,isChatAPIPreAuthCompleted:t}}function c(t){return{type:i.q4,unreadBadgeValue:t}}function h(t){return{type:i.$6,isTeamsChatActivated:t}}function u(){return{type:i.Kx}}function d(t){return{type:i.ij,initChatOnFirstClick:t}}}}]),HighResolutionTimingSupported&&(shellPerformance.mark("shell_chat_end"),shellPerformance.measure("shell_chat","shell_chat_start","shell_chat_end"));